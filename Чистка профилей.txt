DELETE FROM MME_CODES_TO_PROFILES WHERE PROFILE_ID IN(
SELECT PROF_ID FROM PROFILES
EXCEPT
	SELECT PROFILE_ID FROM MME_CODES_TO_PROFILES WHERE MME_CODE_ID =( 
		SELECT MME_CODE_ID FROM MME_CODES WHERE MME_CODE = 'MME401')
EXCEPT
	SELECT PROF_ID FROM PROFILES WHERE PROF_GUID IN (
		SELECT PROFILE_ID FROM DEVICES ))
	

DELETE FROM PROF_COND WHERE PROF_ID IN(
SELECT PROF_ID FROM PROFILES
EXCEPT
	SELECT PROFILE_ID FROM MME_CODES_TO_PROFILES WHERE MME_CODE_ID =( 
		SELECT MME_CODE_ID FROM MME_CODES WHERE MME_CODE = 'MME401')
EXCEPT
	SELECT PROF_ID FROM PROFILES WHERE PROF_GUID IN (
		SELECT PROFILE_ID FROM DEVICES ))

DELETE FROM PROF_PARAM WHERE PROF_ID IN(
SELECT PROF_ID FROM PROFILES
EXCEPT
	SELECT PROFILE_ID FROM MME_CODES_TO_PROFILES WHERE MME_CODE_ID =( 
		SELECT MME_CODE_ID FROM MME_CODES WHERE MME_CODE = 'MME401')
EXCEPT
	SELECT PROF_ID FROM PROFILES WHERE PROF_GUID IN (
		SELECT PROFILE_ID FROM DEVICES ))

DELETE FROM PROF_TEST_TYPE WHERE PROF_ID IN(
SELECT PROF_ID FROM PROFILES
EXCEPT
	SELECT PROFILE_ID FROM MME_CODES_TO_PROFILES WHERE MME_CODE_ID =( 
		SELECT MME_CODE_ID FROM MME_CODES WHERE MME_CODE = 'MME401')
EXCEPT
	SELECT PROF_ID FROM PROFILES WHERE PROF_GUID IN (
		SELECT PROFILE_ID FROM DEVICES ))


DELETE FROM PROFILES WHERE PROF_ID IN(
SELECT PROF_ID FROM PROFILES
EXCEPT
	SELECT PROFILE_ID FROM MME_CODES_TO_PROFILES WHERE MME_CODE_ID =( 
		SELECT MME_CODE_ID FROM MME_CODES WHERE MME_CODE = 'MME401')
EXCEPT
	SELECT PROF_ID FROM PROFILES WHERE PROF_GUID IN (
		SELECT PROFILE_ID FROM DEVICES ))



/////////////////////////////////////////////////////////////////////////////////////////////////////
		
DELETE FROM DEV_ERR WHERE DEV_ID IN (
	SELECT DEV_ID FROM DEVICES WHERE DEV_ID IN(
		SELECT PROF_GUID FROM PROFILES
		EXCEPT
		SELECT PROF_GUID FROM PROFILES  WHERE PROF_ID IN (
			SELECT PROFILE_ID FROM MME_CODES_TO_PROFILES WHERE MME_CODE_ID =( 
				SELECT MME_CODE_ID FROM MME_CODES WHERE MME_CODE = 'MME401'))))		
				
DELETE FROM DEV_PARAM WHERE DEV_ID IN (
	SELECT DEV_ID FROM DEVICES WHERE PROFILE_ID IN(
		SELECT PROF_GUID FROM PROFILES
		EXCEPT
		SELECT PROF_GUID FROM PROFILES  WHERE PROF_ID IN (
			SELECT PROFILE_ID FROM MME_CODES_TO_PROFILES WHERE MME_CODE_ID =( 
				SELECT MME_CODE_ID FROM MME_CODES WHERE MME_CODE = 'MME401'))))							



DELETE FROM DEVICES WHERE PROFILE_ID IN(
	SELECT PROF_GUID FROM PROFILES
	EXCEPT
	SELECT PROF_GUID FROM PROFILES  WHERE PROF_ID IN (
		SELECT PROFILE_ID FROM MME_CODES_TO_PROFILES WHERE MME_CODE_ID =( 
			SELECT MME_CODE_ID FROM MME_CODES WHERE MME_CODE = 'MME401')))



